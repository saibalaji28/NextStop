{% extends "base.html" %}

{% block content %}
<h1 class="text-xl font-bold mb-6">Route Finder</h1>

<form method="post" class="max-w-md bg-white p-6 rounded shadow">
    {% csrf_token %}

    <!-- Source -->
    <label class="block mb-2 font-medium">Source Station</label>
    <select name="source" class="border p-2 mb-4 w-full rounded">
        {% for station in stations %}
            <option value="{{ station.name }}">
                {{ station.name }}
            </option>
        {% endfor %}
    </select>

    <!-- Destination -->
    <label class="block mb-2 font-medium">Destination Station</label>
    <select name="destination" class="border p-2 mb-4 w-full rounded">
        {% for station in stations %}
            <option value="{{ station.name }}">
                {{ station.name }}
            </option>
        {% endfor %}
    </select>

    <button type="submit"
        class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        Find Route
    </button>
</form>

<!-- ERROR MESSAGE -->
{% if result.error %}
<div class="mt-6 p-4 bg-red-100 text-red-700 rounded">
    {{ result.error }}
</div>
{% endif %}

<!-- SELECTED STATIONS -->
{% if result.source and result.destination %}
<div class="mt-6 p-4 bg-white shadow rounded">
    <h2 class="font-bold mb-2">Selected Stations</h2>
    <p><strong>From:</strong> {{ result.source }}</p>
    <p><strong>To:</strong> {{ result.destination }}</p>
</div>
{% endif %}

<!-- ROUTE DETAILS -->
{% if result.path %}
<div class="mt-6 p-6 bg-white shadow rounded space-y-2">
    <h2 class="font-bold mb-2">Route Details</h2>

    <p>
        <strong>Stations Path:</strong><br>
        {{ result.path|join:" → " }}
    </p>

    <p>
        <strong>Total Stations:</strong>
        {{ result.stations_count }}
    </p>

    <p>
        <strong>Interchanges:</strong>
        {{ result.interchanges }}
    </p>

    <p>
        <strong>Estimated Time:</strong>
        {{ result.time }} minutes
    </p>

    <p class="text-lg font-semibold text-green-700">
        Fare: ₹{{ result.fare }}
    </p>
</div>
{% endif %}
{% if result.instructions %}
<div class="mt-6 p-4 bg-white shadow rounded">
    <h2 class="font-bold mb-3">Journey Instructions</h2>
    <ol class="list-decimal ml-6 space-y-1">
        {% for step in result.instructions %}
            <li>{{ step }}</li>
        {% endfor %}
    </ol>
</div>
{% endif %}

{% endblock %}